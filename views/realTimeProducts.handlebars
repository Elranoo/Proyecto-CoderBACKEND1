<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Productos en Tiempo Real</title>
    <link rel="stylesheet" href="/css/style.css">
    <script src="/socket.io/socket.io.js"></script>
</head>
<body>
    <h1>Productos en Tiempo Real</h1>

    <form id="addProductForm">
        <input type="text" name="title" placeholder="Título" required>
        <input type="text" name="description" placeholder="Descripción">
        <input type="text" name="code" placeholder="Código" required>
        <input type="number" name="price" placeholder="Precio" required>
        <input type="number" name="stock" placeholder="Stock">
        <input type="text" name="category" placeholder="Categoría">
        <button type="submit">Agregar Producto</button>
    </form>

    <div id="productsContainer"></div>

    <script>
        const socket = io();
        const container = document.getElementById('productsContainer');
        const form = document.getElementById('addProductForm');

function renderProducts(products) {
    container.innerHTML = '';
    products.forEach(p => {
        const div = document.createElement('div');
        div.classList.add('product-card');
        div.innerHTML = `
            <p>ID: ${p.id}</p>
            <h3>${p.title}</h3>
            <button class="delete-btn" data-id="${p.id}">Eliminar</button>
        `;
        container.appendChild(div);
    });

    document.querySelectorAll('.delete-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            const id = btn.getAttribute('data-id');
            socket.emit('deleteProduct', id);
        });
    });
}

        socket.on('updateProducts', (products) => {
            renderProducts(products);
        });

        form.addEventListener('submit', e => {
            e.preventDefault();
            const formData = new FormData(form);
            const product = Object.fromEntries(formData.entries());
            product.price = Number(product.price);
            product.stock = Number(product.stock || 0);
            socket.emit('newProduct', product);
            form.reset();
        });
    </script>
</body>
</html>




